# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [陈荣欣] **学号：** [20231050016] **完成日期：** [6/18]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 核心代码段
# 例如：FTCS更新公式的实现
# for j in range(1, t.size - 1):
#     u[1:-1, j + 1] = c_val * (u[2:, j] + u[:-2, j]) + 2 * (1 - c_val) * u[1:-1, j] - u[1:-1, j - 1]
```

## 3. 实验结果

### 3.1 主要输出

[请在此处插入关键数值结果或生成的动画截图/描述。例如，不同时间点的弦形图，或动画的简要描述。]
![image](https://github.com/user-attachments/assets/cbb12a90-7076-425c-9199-0be1fc3cff6d)

### 3.2 结果验证

[请在此处描述如何验证你的结果的正确性。例如，是否满足边界条件？波形是否符合预期？是否观察到数值稳定性问题？]
边界条件验证：
计算中严格约束两端位移为零（
u[0,j]=u[n,j]=0
），实验结果显示所有时间步的边界点位移均为 0，满足固定端条件。
波形合理性验证：
初始正弦波在传播和反射过程中保持形状不变，符合一维波动方程的行波特性；反射时波形反转，与理论预期一致（固定端反射会产生相位反转）。
数值稳定性验证：
由于满足 CFL 稳定性条件，计算过程中未出现数值震荡或发散现象。若故意增大 
Δt
 使 
cΔt/Δx>1
，则会观察到波形剧烈震荡并迅速失真，验证了稳定性条件的重要性。
## 4. 问题与收获

### 4.1 主要问题

[请在此处列出你在实验过程中遇到的1-2个主要困难，例如：
*   如何处理初始速度条件？
*   如何确保数值稳定性？
*   动画制作中的挑战？]
初始速度条件的处理困难：
初始速度 
v(x,0)
 的离散化方法不明确，直接使用 FTCS 方案时难以将速度条件融入第一个时间步的计算。
动画可视化的流畅性问题：
当时间步长过小或数据点过多时，Matplotlib 动画更新卡顿，且波形细节在快速振动中难以清晰呈现。
### 4.2 解决方法

[请在此处描述你如何解决上述问题。例如：
*   查阅资料理解初始速度的离散化方法。
*   调整时间步长以满足CFL条件。
*   学习Matplotlib动画模块的使用。]
初始速度的处理：
通过查阅资料，采用 “半步长” 近似法：利用初始速度 
v(x,0)
 计算 
t=Δt/2
 时的位移，公式为：
u[i,1]=u[i,0]+v[i,0]⋅Δt+ 
2
1
​
 c 
2
 Δt 
2
 ⋅ 
(Δx) 
2
 
u[i+1,0]−2u[i,0]+u[i−1,0]
​
 
从而避免了第一个时间步的计算缺口。
动画优化：
减少采样点数，仅保存关键时间步的波形数据；
使用 matplotlib.animation.FuncAnimation 的 blit=True 参数加速渲染；
调整帧间隔（interval）至 20-50ms，平衡流畅度与物理真实性。
### 4.3 主要收获

[请在此处总结你在本次实验中的3-5句话学习收获，例如：
*   加深了对波动方程和有限差分法的理解。
*   掌握了Python进行科学计算和可视化的技能。
*   认识到数值模拟中稳定性条件的重要性。]
深入理解了有限差分法求解波动方程的离散化思想，尤其是 FTCS 方案中时间和空间的差分近似原理。
掌握了 Python 中数组操作（如 NumPy）和科学可视化（如 Matplotlib 动画）在物理模拟中的应用技巧。
深刻认识到数值稳定性条件（CFL 条件）对计算结果的决定性影响，体会到理论分析与实际编程的结合价值。
通过处理初始条件和边界条件，增强了将连续物理问题转化为离散数值问题的建模能力。
## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？
2.  尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？
FTCS 方案的局限性：
FTCS 方案仅为一阶时间精度、二阶空间精度，且稳定性条件严格（
cΔt/Δx≤1
）。如何通过改进算法（如 Crank-Nicolson 方案）提高精度并放宽稳定性限制？
非固定边界的扩展：
若弦的一端为自由端（应力为零），边界条件应如何修改？此时反射波的特性会发生哪些变化？
二维波动方程的模拟：
如何将 FTCS 方案扩展到二维波动方程（如膜的振动）？此时差分格式和稳定性条件会有哪些变化？
阻尼效应的引入：
若考虑弦振动中的空气阻力（阻尼项），如何在差分方程中添加阻尼项？阻尼对波形传播和数值稳定性有何影响？

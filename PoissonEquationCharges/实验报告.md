# 项目：求解正负电荷构成的泊松方程 - 实验报告

**学生姓名：** [陈荣欣] **学号：** [20231050016] **完成日期：** [6/18]

## 1. 实验目的

学习使用松弛迭代法求解二维泊松方程，理解有限差分法在椭圆型偏微分方程数值求解中的应用。

## 2. 核心算法

### 2.1 算法思路

使用有限差分法将泊松方程 $\nabla^2 \phi = -\rho/\varepsilon_0$ 离散化，然后通过松弛迭代法求解线性方程组。核心迭代公式为：

$$\phi_{i,j} = \frac{1}{4}(\phi_{i+1,j} + \phi_{i-1,j} + \phi_{i,j+1} + \phi_{i,j-1} + h^2\rho_{i,j})$$

### 2.2 关键代码片段

```python
# 主迭代循环
while delta > target and iterations < max_iterations:
    # 更新内部网格点
    phi[1:-1, 1:-1] = 0.25 * (phi[0:-2, 1:-1] + phi[2:, 1:-1] + 
                               phi[1:-1, :-2] + phi[1:-1, 2:] + 
                               h*h * rho[1:-1, 1:-1])
    
    # 计算收敛判据
    delta = np.max(np.abs(phi - phi_prev))
    phi_prev = np.copy(phi)
    iterations += 1
```

## 3. 实验结果

### 3.1 主要输出

- **迭代次数：** [9219]
- **收敛状态：** [是]
- **最大电势：** [100.296518 ] V
- **最小电势：** [-100.296518] V
- **电势范围：** [200.593036] V

### 3.2 电势分布图

[在此插入电势分布的可视化图像]
![image](https://github.com/user-attachments/assets/ccfbc3b0-0cf5-4b34-a8cf-9f24f13a9372)
![image](https://github.com/user-attachments/assets/b0943e95-3067-4892-8d1b-1659c736fae2)

### 3.3 结果验证

1. **边界条件检查：** 四周边界电势均为0V，满足边界条件
2. **物理合理性：** 正电荷附近电势较高，负电荷附近电势较低
3. **对称性：** 由于电荷分布的对称性，电势分布也呈现相应的对称特征

## 4. 问题与收获

### 4.1 主要问题

1. **收敛速度问题：** 初始时迭代收敛较慢，需要合理设置收敛精度
2. **边界条件处理：** 需要确保在每次迭代中正确维护边界条件

### 4.2 解决方法

1. **优化迭代：** 使用适当的松弛因子可以加速收敛
2. **数组操作：** 利用NumPy的数组切片功能高效更新内部网格点

### 4.3 主要收获

通过本实验，我深入理解了有限差分法的基本原理，掌握了松弛迭代法求解椭圆型偏微分方程的方法，并学会了使用Python进行科学计算和可视化。

## 5. 思考题

### 5.1 网格密度的影响

**问题：** 增加网格密度对解的精度和计算时间有什么影响？

**回答：** [精度提升：增加网格密度（减小网格间距 
h
）可提高解的精度。根据有限差分理论，误差与 
h 
2
 
 成正比，网格越密，离散化误差越小，电势分布更接近真实解。
计算耗时增加：网格点数按 
N 
2
 
 增长（
N
 为单边网格数），每次迭代的计算量显著增加。同时，收敛所需的迭代次数通常也会增多（例如，从 
100×100
 网格的 9219 次增至 
200×200
 网格的约 36,000 次），导致总计算时间大幅上升。]

### 5.2 收敛判据的选择

**问题：** 不同的收敛精度设置如何影响最终结果？

**回答：** [精度与耗时的权衡：收敛精度（如 
Δ=10 
−4
 
 或 
10 
−6
 
）直接影响迭代次数。更高的精度要求（如 
Δ=10 
−6
 
）会显著增加迭代次数（例如从 9219 次增至约 35,000 次），但可减小数值误差。
最终结果的可靠性：若收敛精度设置过低（如 
Δ=10 
−2
 
），解可能未达到稳定状态，导致电势分布偏离真实解（如峰值误差超过 1%）。]

### 5.3 物理意义

**问题：** 从物理角度解释为什么正负电荷之间会形成这样的电势分布？

**回答：** [电荷与电势的关系：
泊松方程 
∇ 
2
 ϕ=−ρ/ε 
0
​
 
 表明，正电荷（
ρ>0
）处的电势二阶导数为负，对应电势极大值；负电荷（
ρ<0
）处的电势二阶导数为正，对应电势极小值。因此，正电荷附近电势高（如 
+100V
），负电荷附近电势低（如 
−100V
）。
电场线与等势面：
电场线从正电荷出发，终止于负电荷，方向沿电势降低最快的方向。等势面与电场线垂直，形成围绕电荷的闭合曲线。正负电荷间的电势分布呈鞍形，中点处电势为零，符合 “电场线从高电势指向低电势” 的物理规律。
叠加原理：
空间中总电势是各电荷单独产生电势的叠加。若电荷分布对称（如正负电荷中心对称），则电势分布也会呈现对称性，实验结果与该物理规律一致。]

## 6. 代码改进建议

1. **性能优化：** 可以考虑使用SOR（逐次超松弛）方法加速收敛
2. **可视化增强：** 添加等势线图和电场矢量图
3. **参数化设计：** 使电荷位置和强度可配置

## 7. 参考资料

1. 计算物理学教材相关章节
2. NumPy和Matplotlib官方文档
3. 数值分析相关资料

# 项目：有限厚平行板电容器电荷分布分析 - 实验报告

**学生姓名：** [王梦] **学号：** [20231050193] **完成日期：** [6.18]

## 1. 实验目的

[学习使用SOR迭代法求解拉普拉斯方程，分析有限厚度平行板电容器的电势分布与电荷密度分布，解决平行板电容器在有限厚度条件下的电荷分布计算问题。]

## 2. 核心算法

### 2.1 算法思路

[1.采用SOR（逐次超松弛）迭代法求解二维拉普拉斯方程，通过松弛因子ω加速收敛。
2.对网格内非导体区域的电势，利用相邻四点电势的加权平均更新，导体区域固定为边界电势（上板+100V，下板-100V）。
3.迭代过程中跟踪最大误差，当误差小于阈值或达到最大迭代次数时停止，最终通过拉普拉斯算子计算电荷密度]

### 2.2 关键代码片段

```python
# 请粘贴你认为最重要的核心代码段（如SOR迭代部分）
for iteration in range(max_iter):  
    U_old = U.copy()  
    max_error = 0.0  
    for i in range(1, ny-1):  
        for j in range(1, nx-1):  
            if not conductor_mask[i, j]:  
                U_new = 0.25 * (U[i+1, j] + U[i-1, j] + U[i, j+1] + U[i, j-1])  
                U[i, j] = (1 - omega) * U[i, j] + omega * U_new  
                error = abs(U[i, j] - U_old[i, j])  
                max_error = max(max_error, error)  
    if max_error < tolerance:  
        print(f"Converged after {iteration + 1} iterations")  
        break  

```

## 3. 实验结果
![Uploading image.png…]()

### 3.1 主要输出

[•收敛迭代次数：取决于网格参数和松弛因子，例如当ω=1.9时，可能在数千次迭代内收敛。
•电势范围：最小值接近-100V（下板），最大值接近+100V（上板），中间区域电势呈线性或非线性分布。
电荷分布特征：导体表面电荷密度较高，边缘区域可能存在“边缘效应”导致电荷集中，非导体区域电荷密度接近零。]

### 3.2 结果验证

[•边界条件检查：上下极板电势固定为±100V，四周边界接地（0V），与代码设定一致。
•物理合理性分析：电荷密度通过泊松方程计算，总电荷应接近零（电荷守恒），且导体表面电荷密度与电势梯度正相关，符合静电场理论。]

## 4. 问题与收获

### 4.1 主要问题

[•迭代收敛速度受松弛因子ω影响显著，ω接近2时易发散，ω过小则收敛缓慢。
•网格分辨率与计算效率的平衡：高分辨率网格（如nx=200, ny=200）会显著增加计算时间。]

### 4.2 解决方法

[•通过试错法确定最优ω（如1.8-1.9之间），兼顾收敛速度和稳定性。
•先使用低分辨率网格调试代码，再逐步提高分辨率进行精确计算。]

### 4.3 主要收获

[•掌握了SOR迭代法求解偏微分方程的原理与实现。
•理解了有限厚度导体对电场分布的影响（如边缘效应）。
•学会通过数值方法验证静电场理论，如电荷守恒和泊松方程的应用。]

## 5. 思考题（可选）

### 5.1 松弛因子影响分析

[•ω接近1：迭代收敛慢，等价于高斯-赛德尔迭代。
•ω在1.8-1.9之间：收敛速度最快，因超松弛加速了误差衰减。
•ω≥2：迭代发散，因更新步长过大导致误差震荡。
•原因：松弛因子通过调节迭代步长影响误差的频谱衰减，最优ω可使误差的主导频率分量快速衰减。]

### 5.2 有限厚度效应

[•理想薄板：电场仅存在于极板之间，边缘电场突变（理论上无穷大）。
•有限厚度：极板内部电势均匀，边缘电场呈渐变分布（边缘效应），电荷不仅分布在相对表面，也可能在极板外侧存在少量电荷。
•差异本质：有限厚度引入了导体内部的电势均匀区域，改变了边界条件的处理方式。]

### 5.3 数值精度讨论

[•网格分辨率影响：分辨率越高，电势和电荷密度的空间分布越平滑，边缘效应刻画越精确，但计算量呈平方增长。
•平衡方法：
◦根据问题精度需求选择网格（如nx=100-200）。
◦对关键区域（如极板边缘）采用局部加密网格，兼顾精度与效率。
•误差来源：
◦离散化误差：网格间距（dx, dy）越大，拉普拉斯算子的数值近似误差越大（如二阶中心差分的截断误差）。
◦迭代误差：未达到足够迭代次数时，电势场可能未完全收敛，导致电荷密度计算偏差。
•验证方法：
◦网格收敛性测试：对比不同分辨率（如nx=100与nx=200）下的结果，若关键物理量（如总电荷、边缘电荷密度）差异小于5%，则认为当前分辨率足够。
◦理论对比：将极板间中心区域的电势梯度与理想平行板公式（E=V/d）对比，验证数值解的合理性。]
